% !TEX root = ../Thesis.tex
\acresetall
\myChapter{Computed Tomography}\label{ch:ct}
\begin{flushright}{\slshape More apparatus, please, nurse.\\
				Get the EEG, the BP monitor, and the AVV.\\
				And get the machine that goes "PING!"\\
				And get the most expensive machine in case the Administrator comes.} \\ \medskip
	--- John Cleese \& Graham Chapman as Obstetricians in\defcitealias{TheMeaningOfLife}{The Meaning of Life}\citetalias{TheMeaningOfLife} \citep{TheMeaningOfLife}
\end{flushright}
\vspace{52mm}
\ac{ct} is an imaging method where a three-dimensional image of the internal structure of an object is generated from a series of two-dimensional x-ray images---single radiographies---which have been taken at equidistant angles around a single rotation axis. The word tomography is derived from the greek words for tomos (\greektext tomos\latintext, slice) and grafia (\greektext graf'ia\latintext, describing). Combining tomographic image acquisition with x-ray microscopy based on synchrotron radiation allows to obtain volumetric information of a specimen at sub-micron resolution with only minimal sample preparation~\cite{Stampanoni2006a} in a matter of minutes~\cite{Hintermueller2010}.

This chapter presents a short rundown on the history of \ac{ct} and the underlying principles of the interaction of radiation with matter. Subsequently, the theory behind tomographic reconstruction is presented. The chapter ends with a short description of the machine that goes ``PING''---the beamline for \ac{tomcat} at the \ac{sls} in Villigen, Switzerland---where all experiments of this thesis have been performed.

\section{History}
\acl{ct} has come a long way since the late 1970, where Sir Godfrey Hounsfield invented the first commercially available thanks to the upcoming availability of microcomputers\todo{citation?}.

The basic idea of todays tomography was already described in a patent granted to \citet{Frank1942} in the 1940s and several experiments around 1960--1965 showed the feasibility of three-dimensional reconstruction of an object which has been penetrated by radiation~\cite{Hsieh2003}. The first tomographic imagers produced radiographic images of selected sections of tissue by moving the x-ray source and the film over and under the patient in the opposite direction. This approach blurred structures lying out of the selected region of interest. But this advance over conventional radiographies was insufficient to make two-dimensional tomographic images a useful diagnostic tool~\cite{Robb2003}.

While observing the planning of radiotherapy treatments, Allan M.\ Cormack realized that these treatments would greatly benefit if the x-ray attenuation coefficient distribution in the body would be known. In 1963 \citet{Cormack1963} reported about the investigation of a cylindrical disk with a diameter of \SI{20}{\centi\meter} which was made of two concentric aluminum cylinders embedded in an oak annulus. Using a collimated \isotope[60]{Co} source and a Geiger counter as a detector, \citeauthor{Cormack1963} was able to detect the absorption coefficients of the materials in the cylinder and repeated this experiments with an asymmetrical phantom consisting of aluminum and plastic. But since the calculations necessary for the extraction of the attenuation coefficients were both time-consuming and difficult, the presented results never really caught on. Cormack remarked that \begin{quote} There was virtually no response. The most interesting request for a reprint came from a Swiss Centre for Avalanche Research\graffito{Sigi, this quote is especially for you!}. The method would work for deposits of snow on mountains if one could get either the detector or the source into the mountain under the snow! \cite{Cormack1979}\end{quote}

In 1967, Godfrey N.\ Hounsfield started to develop the first clinical tomography scanners at the EMI Central Research Laboratories in the United Kingdom~\cite{Hsieh2003}. The first laboratory scanners took 9 days to acquire a scan of one slice of a cow brain~\cite{Hounsfield1976}, but paved the path to the first clinically available \ac{ct} machines in hospitals and the scientific community. In 1979 Cormack and Hounsfield shared the Nobel Prize for Physiology and Medicine for their pioneering work in \ac{ct}.

From the early 1980s on, \ac{ct} imaging became an important tool to answer scientific questions both in medical and industrial applications.

Even if these medical \ac{ct} scanners are in widespread use, their images suffer from relatively low spatial resolution in the sub-millimeter scale, which is often not enough to detect the finest details in biological samples. Since the radiation dose limitations imposed for medical scans often do not apply for biological samples which are dried, frozen or embedded in paraffin or plastic, more intense and collimated x-ray sources can be used. Using such sources in \ac{uct} stations enables to reach resolutions in the sub-micrometer range\todo{citation?}. Since synchrotron radiation is even more powerful than the x-ray tubes used for \ac{uct}, its use as an x-ray source to produce highly intensive beams for microtomography has been proposed as early as in \citeyear{Grodzins1983} by \citet{Grodzins1983,Grodzins1983a}.

\section{Interaction of radiation with Matter}
To be able to introduce the physical principles of \ac{ct}, some important interactions of x-rays with matter have to be introduced. The energy of the x-ray photons available at \ac{tomcat}, where all the experiments of this work have been performed is in the range of 8--\SI{45}{\kilo\electronvolt}\graffito{The experiments presented in \autoref{part:results} have been performed between \SI{11.5}{\kilo\electronvolt} and \SI{12.6}{\kilo\electronvolt}.%
% XRM 11.5 keV
% Tsuda 12.398 keV
% Haberthuer 12.6 keV
}, we can thus limit the explanation to absorption, Rayleigh and Compton scattering. We neglect the description of electron-positron pair production, which occurs only for x-ray energies above \SI{1}{\mega\electronvolt}.

\subsection{Absorption}\label{sec:absorption}
In the relevant absorption process---the so-called photoelectric effect---an incoming x-ray photon with energy $E_{\gamma}$ interacts with a bound atomic electron in a deep shell of the atom and is completely absorbed. This process only happens if $E_{\gamma}$ is greater than the binding energy $E_{Shell}$ of the shell electron and releases a photo-electron with the energy $\Delta E=E_{\gamma}-E_{Shell}$. This liberation creates a hole in the deep shell, which is immediately filled by electrons from outer shells of the atom. Since the electron from the outer shell is at a higher energy state than the inner shell electron, a cascade process is initiated which results in the emission of radiation which is characteristic for the absorbing atom.

\subsection{Scattering}
\subsubsection{Compton scattering}
\citet{Compton1923} first described this inelastic scattering\graffito{In inelastic scattering the kinetic energy of an incident particle is not conserved.} effect which is observed when an incident photon with an Energy $E=h\nu$ transfers parts of its energy to a scattering electron which is subsequently ejected from the atom.

To conserve the overall momentum of the system, the electron recoils at an angle $\theta$ and the photon is scattered in a direction $\phi$ with a reduced energy $E=h\nu'$, where $h$ denotes the Planck constant\graffito{The Planck constant is named after Max Planck, one of the founders of quantum theory and describes the relation between the energy ($E$) of a photon and the frequency of its associated electromagnetic wave ($\nu$)}. If the photon still has enough energy left, the process may be repeated, if the photon is of lower energy, it can subsequently be absorbed as described above in \autoref{sec:absorption}. The reduction in the energy of the recoil electron leads to a shift in the wavelength $\Delta\lambda$ which can be calculated using \autoref{eq:hnu}
\begin{equation}
	%h\nu'=\frac{h\nu}{1+\frac{h\nu}{m_{e}c^{2}}(1-cos\theta)}
	\Delta\lambda = \lambda' - \lambda = \frac{h}{m_e c}(1-\cos{\theta})
	\label{eq:hnu}
\end{equation}
where $m_e$ stands for the electron mass and $c$ for the speed of light.

\subsubsection{Coherent scattering}
Coherent or Rayleigh scattering is an interaction process where no ionization occurs and no energy is converted into kinetic energy. The incident electromagnetic wave sets the electrons in the magnetic field into vibration with an oscillating electric field. The oscillating electrons emit coherent radiation, but since not all electrons are located at the same point inside the atom, the emitted radiation is not in phase~\cite{Hsieh2003,Stampanoni2002}.

\autoref{fig:InteractionPercentage} shows the relative percentages of interaction for the different interaction types. Note that albeit pair production albeit is shown in the plots, it has not been described, since it is only relevant for energies much higher than the energies used in the experiments in this thesis, performed around \SI{12}{\kilo\electronvolt}. For this energy, the photoelectric absorption is the major interaction process, even if it rapidly decreases for higher energies. Not only is the interaction rate higher for the photoelectric effect, but also the major part of the energy is transferred, since more energy is transferred in a photoelectric interaction than in a Compton interaction.

\def\width{0.5\linewidth}%
\def\height{0.309\linewidth}% =0.8*0.618
\begin{figure}
	\noindent\makebox[\textwidth]{%
		\centering%
		\subfloat[Overview]{%
			\input{Plots/InteractionPercentage-Big}%
			\label{subfig:Interaction-Big}%
			}%
		\subfloat[Detailed view]{%
			\input{Plots/InteractionPercentage-Small}%
			\label{subfig:Interaction-Small}%
			}%
		}%
	\caption[Interaction types]{Percentage of the different interaction types specified above as a function of the beam energy in water. \subref{subfig:Interaction-Big}: Overview over the full given energy range. \subref{subfig:Interaction-Small}: Detailed view. The lightgray region is the energy-range of \ac{tomcat}, the dark gray region marks the energy range of the experiments described in chapters~\ref{ch:xrm2008}--\ref{ch:haberthuer2010} of this thesis. Data from~\citet[Table 5-5]{Johns1983}, unfortunately data below \SI{10}{\kilo\electronvolt} is missing in the source.}%
	\label{fig:InteractionPercentage}%
\end{figure}

\subsection{Attenuation}
The total effect of the three effects described above can be summarized with the total linear attenuation coefficient shown in \autoref{eq:linear attenuation}. This equation expresses the attenuation of a monochromatic\graffito{Monochromatic light is light of a single wavelength or energy, though in practice it often refers to a narrow wavelength range} beam as it passes through a material. The attenuation in a material of uniform density and atomic number can be expressed by an exponential relationship%
\begin{equation}%
	I=I_{0}e^{-(\tau+\sigma_{C}+\sigma_{R})x}%
	\label{eq:linear attenuation}%
\end{equation}%
where $I$ and $I_{0}$ are the incident and transmitted intensities of the x-rays and $x$ is the distance which the x-rays travel through the material. $\tau$, $\sigma_{C}$ and $\sigma_{R}$ are the attenuation coefficients of the photoelectric, incoherent (Compton) and coherent (Rayleigh) scattering interactions in the material, respectively. \autoref{eq:linear attenuation} is often expressed as
\begin{equation}
	I/I_{0}=e^{-\mu x}
	\label{eq:beer-lambert}
\end{equation}%
the so-called Beer-Lambert law, where $\mu$ is the attenuation coefficient of the material, which is depending on the incident x-ray photon energy~\cite{Hsieh2003}. 

\autoref{fig:yag attenuation} shows the composition of the attenuation coefficient for Cerium doped \ac{yag} (\cf{Y3Al5O12}), which is used as a material for converting the incident x-rays to visible light. This so-called scintillator is part of the microtomography station at \ac{tomcat} and is described in detail in \autoref{sec:tomcat}.

\def\width{\linewidth}%
\def\height{0.618\linewidth}%
\begin{figure}
	\noindent\makebox[\textwidth]{%
		\centering
		\input{Plots/YAGattenuation}%
		}
	\caption[Total attenuation coefficient of Ce:YAG]{Total attenuation coefficient of Ce:YAG (\cf{Y3Al5O12}), the scintillator material used for converting the incident x-rays to visible light in the experiments presented in chapters~\ref{ch:xrm2008}--\ref{ch:haberthuer2010}. The lightgray region is the energy-range of \ac{tomcat}, the dark gray region marks the energy range of the experiments described in chapters~\autoref{ch:xrm2008}--\ref{ch:haberthuer2010} of this thesis. Data from the photon cross section database~\cite{XCOM}.}
	\label{fig:yag attenuation}
\end{figure}

\section{From Projections to Slices: Computed tomography}
In general, \ac{ct} refers to the cross-sectional imaging of a sample from transmission images or projections recorded at several equiangular positions around the sample~\cite{Kak2002}.

In medical \ac{ct}-scanners, the transmission images are generally obtained while the radiation source and the detector rotate around the body part to be imaged. In micro-computed and synchrotron based tomography, the source and detector are fixed, while the sample to be imaged rotates around a chosen axis.

During the imaging process multiple transmission images---essentially single radiographic images---are obtained at several equidistant angles over a \unit{180}{\degree} or \unit{360}{\degree} rotation. These projections can be understood as pictures of the distribution of the attenuation of the x-rays inside the sample. Regions with high attenuation show up as dark pixel, regions with low attenuation inside the sample show up as light pixels on the \ac{ccd}-chip of the camera.

Before and after the scan, so-called dark ($I_{D}$) and flat images ($I_{F}$) are recorded. The dark images record the camera noise and dark current, while the flat images record the beam profile. After baseline correction of the projections ($I_{P}$) the average of the dark images is subtracted. The projections are then normalized to the flat images as seen in \autoref{eq:cpr}, using the average dark and average flat images ($\overline{I_{D}}$ and $\overline{I_{F}}$, respectively) resulting in so-called corrected projections (CPR).%
\begin{equation}%
	CPR=-ln\left(\frac{I_{P}}{\overline{I_{F}}}\right)=ln(\overline{I_{F}})-ln(I_{P})%
	\label{eq:cpr}%
\end{equation}%

\autoref{fig:corrected projection} shows the results of correcting a raw projection obtained at \ac{tomcat} with a flat image into a corrected projection.

\renewcommand{\imsize}{0.333\linewidth}
\begin{figure}
	\centering
	\pgfmathsetlength{\imagewidth}{\imsize}%
	\pgfmathsetlength{\imagescale}{\imagewidth/1024}%
	\def\x{633}% scalebar-x at golden ratio of x=1024px
	\def\y{922}% scalebar-y at 90% of height of y=1024px
	\subfloat[Projection $PI$]{%
		\begin{tikzpicture}[x=\imagescale,y=-\imagescale]
			\node[anchor=north west, inner sep=0pt, outer sep=0pt] at (0,0) {\includegraphics[width=\imagewidth]{img/tif-sin-rec/L-XXI-18_B50287-projection}};
			% 1024px = 1.5155mm > 100px = 148um > 338px = 500um, 68px = 100um
			%\draw[|-|,thick] (0,512) -- (1024,512) node [sloped,midway,above] {\SI{1.5155}{\milli\meter} (1024px)};
			\draw[white,|-|,thick] (\x,\y) -- (\x+338,\y) node [midway, above] {\SI{500}{\micro\meter}};
		\end{tikzpicture}%			
		\label{subfig:pi}%
		}%
	\subfloat[Flat Image $FI$]{%
		\begin{tikzpicture}[x=\imagescale,y=-\imagescale]
			\node[anchor=north west, inner sep=0pt, outer sep=0pt] at (0,0) {\includegraphics[width=\imagewidth]{img/tif-sin-rec/L-XXI-18_B50006-flat}};
			% 1024px = 1.5155mm > 100px = 148um > 338px = 500um, 68px = 100um
			%\draw[|-|,thick] (0,512) -- (1024,512) node [sloped,midway,above] {\SI{1.5155}{\milli\meter} (1024px)};
			\draw[white,|-|,thick] (\x,\y) -- (\x+338,\y) node [midway, above] {\SI{500}{\micro\meter}};
		\end{tikzpicture}%			
		\label{subfig:fi}%
		}%
	\subfloat[Corrected projection $CPR$]{%
		\begin{tikzpicture}[x=\imagescale,y=-\imagescale]
			\node[anchor=north west, inner sep=0pt, outer sep=0pt] at (0,0) {\includegraphics[width=\imagewidth]{img/tif-sin-rec/L-XXI-18_B50287-correctedprojection}};
			% 1024px = 1.5155mm > 100px = 148um > 338px = 500um, 68px = 100um
			%\draw[|-|,thick] (0,512) -- (1024,512) node [sloped,midway,above] {\SI{1.5155}{\milli\meter} (1024px)};
			\draw[white,|-|,thick] (\x,\y) -- (\x+338,\y) node [midway, above] {\SI{500}{\micro\meter}};
		\end{tikzpicture}%			
		\label{subfig:cpr}%
		}%
	\caption[Correction of the projections with flat images]{Correction of the raw recorded projections with the flat images. \subref{subfig:pi}: Recorded projection image. A set of these is the output of one tomographic scanning session. \subref{subfig:fi}: Flat image; obtained at the start of the scan to record the beam profile. \subref{subfig:cpr}: Corrected projection obtained after \autoref{eq:cpr} has been applied on the projection and flat image shown in panels \subref{subfig:pi} and \subref{subfig:fi}. All three images have a size of 1024$\times$1024 pixels with a size of \SI{1.48}{\micro\meter} each and are from a dataset of a rat lung.}
	\label{fig:corrected projection}
	\todo[inline]{From L-XXI-18: details?}
\end{figure}

The corrected projections are then transformed into so-called sinograms, where the $n$\textsuperscript{th} sinogram is composed of the $n$\textsuperscript{th} line of each projection. From one tomographic scan with 1500 projections recorded with a detector with a size of 2048$\times$2048 pixels, we get a set of 1024 sinograms with a size of 1024$\times$1500 pixels each.

Sinograms inherit their name because the Radon transformation\graffito{The Radon transformation was described in 1917 by Johann \citet{Radon1917} and is the mathematical basis for tomographic imaging.} of a Dirac delta peak resembles a sine wave. The Radon transformation of a cluster of objects appears as an overlay of blurred sine waves with different amplitudes and phases, as shown in \autoref{subfig:sin}, since any object can be considered as a collection of many small points.

One sinogram contains the total information of one plane or slice of the reconstructed tomographic image. We can thus reconstruct the $n$\textsuperscript{th} slice of the tomographic dataset from the $n$\textsuperscript{th} sinogram using different reconstructing algorithms, e.g.\ a standard filtered back-projection algorithm. In a reconstructed slice, the absorption properties of the sample at a certain height are encoded by the gray values of the image, as shown in \autoref{subfig:rec}. This virtual slice into a rat lung sample is part of a dataset permitting a fully three-dimensional, unresticted view into the sample in a non-destructive way.

\renewcommand{\imsize}{0.5\linewidth}
\begin{figure}%
	\centering
	\subfloat[resized Sinogram]{%
		\includegraphics[width=\imsize]{img/tif-sin-rec/L-XXI-18_B50501-sin-DMP-scaled}%
		\label{subfig:sin}%
		}%
	\subfloat[Reconstructed Slice]{%
		\pgfmathsetlength{\imagewidth}{\imsize}%
		\pgfmathsetlength{\imagescale}{\imagewidth/1024}%
		\begin{tikzpicture}[x=\imagescale,y=-\imagescale]
			\def\x{633} % scalebar-x at golden ratio of x=1024px
			\def\y{922} % scalebar-y at 90% of height of y=1024px
			\node[anchor=north west, inner sep=0pt, outer sep=0pt] at (0,0) {\includegraphics[width=\imagewidth]{img/tif-sin-rec/L-XXI-18_B50761-rec-8bit}};
			% 1024px = 1.5155mm > 100px = 148um > 338px = 500um, 68px = 100um
			%\draw[white,|-|,thick] (0,512) -- (1024,512) node [sloped,midway,above] {\SI{1.5155}{\milli\meter} (1024px)};
			\draw[white,|-|,thick] (\x,\y) -- (\x+338,\y) node [midway, above] {\SI{500}{\micro\meter}};
		\end{tikzpicture}%
		\label{subfig:rec}%
		}%
	\caption[Sinogram and Reconstruction]{Sinogram and Reconstruction of the projections of the rat lung sample shown in \autoref{fig:corrected projection}. \subref{subfig:sin}: The $n$\textsuperscript{th} sinogram has been obtained after reordering the $n$\textsuperscript{th} line of each of the 1501 corrected projections. The sinogram has been rescaled to a square format for display purposes, it would have a size of 1024$\times$1501 pixels. It doesn't really make sense to draw a scalebar on a sinogram, it has thus been omitted. \subref{subfig:rec}: The tomographic reconstruction of the complete set of sinograms results in a set of 1024 reconstructed slices with 1024$\times$1024 pixels of a size of \SI{1.48}{\micro\meter} each. This slice can then be used for further processing, measuring and three-dimensional visualization.}
	\label{fig:Sin Rec}
	\todo[inline]{Is it really rat? (L-XXI-18, beamtime 2010a, Matthias Roth)}
\end{figure}

The amount of scanned projections---the number of angles at which projections have been recorded---is defined by the so-called sampling theorem. The sampling theorem as defined by \citet{Shannon1949} states that: \begin{quote}If a function $f(t)$ contains no frequencies higher than $W$ cps, it is completely determined by giving its ordinates at a series of points spaced $1/2\ W$ seconds apart. \cite{Shannon1949}\end{quote}

Paraphrased to tomographic imaging, the sampling theorem states that the minimal number of recorded angles along the rotation of the sample must be at least equal to twice the highest frequency used to scan the sample.

From calculations in polar coordinates one can deduce that for a detector with the size $N$ $M=\frac{\pi}{n}N$ angular projections are required to fulfill the sampling theorem for tomographic reconstruction~\cite{Stampanoni2002a}. Generally, for well-balanced reconstructed image with a size of $N\times N$ pixels, recorded with a detector of the same size, the total number of projections should be roughly equal to $N$~\cite{Kak2002}. In in layman's terms, we can thus say that if we scan a sample with a detector of 1024$\times$1024 pixels, we need to record approximately 1000 projections over a sample rotation of \SI{180}{\degree}.

At \ac{tomcat} this rule of thumb is exactly obeyed in the case of a tomographic scan with a binned\graffito{Binning is the process where 2$\times$2 pixels on the camera are averaged to one pixel, both to reduce the image size and noise.} detector. For a standard scan with an unbinned detector---resulting in images with a size of 2048$\times$2048 pixels---only 1500 projections are acquired, thus violating the rule. But even with this seemingly undersampled data acquisition, reconstructions with very high quality are obtained.

\autoref{ch:haberthuer2010} presents a scanning method where the sampling theorem is deliberately violated both to increase the field of view of \ac{tomcat} and to reduce the radiation dose imparted on the sample.

For classic tomographic imaging, an x-ray tube is used as a source of radiation. In \ac{srxtm}, which was used to obtain the tomographic data for this thesis---as the name suggests---x-rays from a synchrotron are used as a radiation source. The following sections give a short overview over the underlying theory of the synchrotron radiation and a quick rundown on the \ac{sls} and the beamline where all the presented experiments have been carried out.

\section{Synchrotron Radiation}
Synchrotron facilities use the fact that accelerated particles traveling on a curved trajectory emit radiation. If charged particles at relativistic speed undergo a change of direction (\ie in a magnetic field) so-called synchrotron radiation is emitted. 

Synchrotron radiation was first observed as energy loss in electron storage rings used for high energy physics experiments. First generation synchrotron sources for scientific use were beamports at such storage ring facilities, which utilized otherwise lost radiation. Dedicated second-generation synchrotron radiation sources have been built over the years; these were ring-like structures using a series of magnets to control the accelerated particles. Current---third-generation---synchrotron radiation facilities are composed of many straight sections of different lengths, specially optimized to accommodate different magnetic structures used to generate the synchrotron radiation~\cite{Stampanoni2002a,Margaritondo2002,wwwsls}. 

\subsection{Bending Magnets, Undulators and Wigglers}
The three magnetic structures used in synchrotron facilities are bending magnets, undulators and wigglers. All three emit radiation with different characteristics and intensities.

Bending magnets\graffito{Such magnets are also used in traditional televisions, which contain a cathode ray tube, which is essentially a small particle accelerator. They move the electron beam over the screen of the TV tube in a controlled fashion.~\cite{wiki:dipolemagnet}} are used to create a homogeneous magnetic field over a defined distance. The magnetic field inside forces accelerated particles injected into the bending magnet to travel on a circular trajectory. The result is a fan of radiation in the tangential direction of the bend.

\begin{figure}
	\noindent\makebox[\textwidth]{%
		\centering%
		\subfloat[]{%
			\input{TikZ-Files/Radiation-BendingMagnet}%
			\label{subfig:bend}%
			}%
		\hspace{4mm}%
		\def\width{.309\linewidth}%
		\def\height{.309\linewidth}%
		\subfloat[]{%
			\input{Plots/Plot-BendingMagnet}%
			\label{subfig:bend-spectrum}%
			}%
		}
	\caption[Bending magnet radiation]{Bending magnet radiation of wavelength $\lambda$ produced by a relativistic electron traveling in an uniform magnetic field. %
		\subref{subfig:bend}: Electrons execute a circular motion with acceleration directed towards the center. The radiation is directed tangentially outward in a narrow radiation cone with an emission angle of typically $\frac{1}{\gamma}$ where $\gamma$ is the Lorentz contraction factor. %
		\subref{subfig:bend-spectrum}: The radiation spectrum is very broad, analogous to a ``white light'' x-ray light bulb.%
		Adapted from~\cite{Attwood2007}.}% http://is.gd/biHF4
	\label{fig:bending magnets}
\end{figure}

\begin{figure}
	\noindent\makebox[\textwidth]{%
		\centering%
		\subfloat[]{%
			\input{TikZ-Files/Radiation-Undulator}%
			\label{subfig:undulator}%
			}%
		\hspace{4mm}%
		\def\width{.309\linewidth}%
		\def\height{.309\linewidth}%
		\subfloat[]{%
			\input{Plots/Plot-Undulator}%
			\label{subfig:undulator-spectrum}%
			}%
		}
	\caption[Undulator radiation]{Undulator radiation is generated as a highly relativistic electron traverses a periodic magnetic field.%
		\subref{subfig:undulator}: The magnetic field in an undulator is relatively weak and the resultant angular excursions of the electron are smaller than the angular width of the natural radiation cone, $\frac{1}{\gamma}$, normally associated with synchrotron radiation.%
		\subref{subfig:undulator-spectrum}: The frequency spread of undulator radiation can be very narrow, and the radiation can be extremely bright and partially coherent, under certain circumstances. The characteristic emission angle is narrowed by a factor $\sqrt N$, where $N$ is the number of magnetic periods. Typically $N$ is of order 100. Depending on the magnet strength, harmonic radiation may be generated. Adapted from~\cite{Attwood2007}.}%http://is.gd/biHF4
	\label{fig:undulator}
\end{figure}

\begin{figure}
	\noindent\makebox[\textwidth]{%
		\centering
		\subfloat[]{%
			\input{TikZ-Files/Radiation-Wiggler}%
			\label{subfig:wiggler}%
			}%
		\hspace{4mm}%
		\def\width{.309\linewidth}%
		\def\height{.309\linewidth}%
		\subfloat[]{%
			\input{Plots/Plot-Wiggler}%
			\label{subfig:wiggler-spectrum}%
			}%
		}
	\caption[Wiggler radiation]{Wiggler radiation is also generated from a periodic magnet structure. %
		\subref{subfig:wiggler}: In the strong magnetic field the angular excursions are significantly greater than the natural ($\frac{1}{\gamma}$) radiation cone. Because accelerations are stronger in this limit, the radiation generated peaks at higher photon energies and has both a higher photon flux and more power. %
		\subref{subfig:wiggler-spectrum}: The radiation spectrum is very broad, similar to that of the bending magnet. Although more power is radiated, wiggler radiation is less bright because of the substantially increased radiation cone. Adapted from~\cite{Attwood2007}.}% http://is.gd/biHF4
	\label{fig:wiggler}
\end{figure}

Undulators consist of periodic structures of dipole magnets with relatively weak fields. The alternating static magnetic field forces the electrons to harmonically oscillate as they move in the axial direction, resulting in an undulating motion of the particles inside the structure. The weak magnetic fields cause small amplitude undulation which leads to a narrow radiation cone as a result. Through coherent addition of the tightly confined electron beam, the produced radiation is emitted with small angular divergence and concentrated in narrow energy bands~\cite{Stampanoni2002a}.

Wigglers are the strong brothers of the undulators. Due to stronger magnetic fields the oscillation amplitude of the electrons and the emitted radiation power are larger and the radiation cone is broader.

The relativistic electrons inside the storage ring are usually produced by a hot filament and subsequently pre-accelerated and injected into the storage ring by a linear accelerator. Bending magnets along the storage ring keep the electrons on their circular path. Quadrupole magnets along the ring are used to improve the geometrical characteristics of the electron beam, \ie reduce the transverse section and angular spread of the beam, hence improving the so-called brightness of the source~\cite{Margaritondo2002}.

Using one of the three above mentioned structures, the radiation is then outcoupled of the storage ring and transferred into the measuring hut. At \ac{tomcat} the radiation is outcoupled using a very stron bending magnet, a so-called superbend, which is described in detail below.

\section{The Swiss Light Source}
The \ac{sls} at the \ac{psi} in Villigen, Switzerland is a third-generation synchrotron light source. With an energy of \SI{2.4}{\giga\electronvolt}, it provides photon beams of high brightness for research in materials science, biology and chemistry.

\renewcommand{\imsize}{0.618\linewidth}%
\begin{figure}
	\centering
	\includegraphics[width=\imsize]{img/SLS_beamlines_2008}
	\caption[Beamlines at the Swiss Light Source]{Beamlines at the \ac{sls}. Image from the \href{http://sls.web.psi.ch/view.php/beamlines/}{SLS Website}}
	\label{fig:beamlines}
\end{figure}

\section{TOMCAT}\label{sec:tomcat}
At the beamline for \acf{tomcat} the user can perform absorption as well as phase contrast imaging with an isotropic voxel\graffito{A voxel or volumetric pixel is the \threed analogy to a \twod pixel.} size ranging from \SI{350}{\nano\meter} up to \SI{14.8}{\micro\meter}, depending on the chosen magnification. Typical acquisition times are in the order of a few minutes for a full sample, depending on the selected energy and resolution.

\citet{Stampanoni2006a} described the \ac{tomcat} beamline in detail, a short rundown on the most important features are presented here: The beamline is located at the X02DA port of the SLS and started regular user operation in June 2006. Synchrotron light is delivered by a \SI{2.9}{\tesla} bending magnet with a magnetic field more than double the strength of the normal \ac{sls} bending magnets. This enables to have a high critical energy of the source (\SI{11.1}{\kilo\electronvolt}, corresponding to a wavelength of \SI{1.22}{\angstrom}) and results in a considerable increase of flux\graffito{Flux is defined as the amount of particles, mass or energy which flows through an area in a certain time and essentially describes the brightness of the beam} at the desired energy range.

Because of the high coherence of the used synchrotron radiation is desired to be kept until the radiation penetrates the sample, a minimization of the optical elements was targeted during the design of the beamline. A \SI{100}{\micro\meter} thick diamond window separates the ultra high vacuum (\SI{e-10}{\millibar}) from the vacuum section of the beamline (\SI{e-7}{\millibar}). After the beam passes the diamond window, its energy is selected using a double crystal multilayer monochromator (Strumenti Scientifici CINEL s.r.l., Padova, Italy). This main optical component of the beamline covers an energy range of 6--\SI{45}{\kilo\electronvolt} with a bandwidth of a few percent down to a few permille~\cite{Stampanoni2006a}.

After collimation, the beam travels through an evacuated pipe into the measuring hut and is directed towards the sample. The sample sits atop a high precision sample manipulator (resolution better than \SI{1}{\micro\meter}, the manipulator is shown in \autoref{fig:tomcat}) which is used for centering the sample in the beam and for the rotation of the sample for tomographic imaging. 

The x-rays which penetrated the sample are detected using a combination of a scintillator, microscope optics and a \ac{ccd}-camera. The scintillator\graffito{The latin word \textit{scintillare} can be translated with sparkling or flickering.} converts incident x-rays to visible light through fluorescence. Charged particles excite the scintillator material and this excitation energy is then subsequently emitted by fluorescence photons at a longer wavelength, which makes it possible to detect the incident beam using a \ac{ccd}-camera. The camera at \ac{tomcat} features a detector with 2048$\times$2048 pixels with a size of 7.4$\times$\SI{7.4}{\micro\meter} each and can read out a full frame \SI{14}{\bit} image in \SI{260}{\millisecond}. Between the scintillator and the \ac{ccd}-sensor interchangeable microscope objectives enable to easily vary the pixel size range of the resulting tomographic reconstructions from 350$\times$\SI{350}{\nano\meter} up to 5.6$\times$\SI{5.6}{\micro\meter}. Depending on the chosen pixel size, the resulting field of view of a standard scan varies between 0.75$\times$\SI{0.75}{\milli\meter\squared} and 11.45$\times$\SI{11.45}{\milli\meter\squared}\graffito{See \autoref{ch:haberthuer2010} for a method to increase the field of view of tomography endstations while keeping the small voxel size.}.

\renewcommand{\imsize}{0.5\linewidth}
\begin{figure}
	\subfloat[Overview]{%
		\includegraphics[width=\imsize]{img/TOMCAT1}%
		\label{subfig:TOMCAT1}%
		}%
	\subfloat[Detail]{%
		\includegraphics[width=\imsize]{img/TOMCAT2}%
		\label{subfig:TOMCAT2}%
		}%
	\caption[The TOMCAT endstation]{The \ac{tomcat} endstation. \subref{subfig:TOMCAT1}: Overview: The blue structure behind the control notebook is the sample stage with the sample holder on the rotation stage on top of it. The black structure above contains the scintillator, the microscope optics and the camera. \subref{subfig:TOMCAT2}: Detail of the microscope optics: The sample holder with a mounted standard electron microscopy sample table is carrying a small piece of a rat lung which can be seen in the reflection. The round structure behind the sample contains the different objectives. The reflecting rectangle visible under the label on the objective revolver is the scintillator which is used to convert the x-ray beam into visible light, which after magnification is then recorded with the \ac{ccd}-camera.}%
	\label{fig:tomcat}
\end{figure}

The sample positioning in the beam (using the sample stage shown in \autoref{fig:tomcat}) and the parameters of the scan---like exposure time, amount of projections, name, etc.---are controlled from outside the measuring hut through an \ac{epics}.

After the start has been started, sinograms are calculated on the fly and the tomographic reconstruction can be initialized using a web-based interface seconds after the scan has been finished. This interface and the general reconstruction workflow and management of the reconstruction cluster has been thoroughly described by \citet{Hintermueller2010}.

The web-based interface is used to submit the reconstruction of the tomographic datasets to a computing cluster of five \SI{64}{\bit} Opteron machines with four cores and \SI{8}{\giga\byte} \acs{ram} each. Immediately after reconstruction on the cluster the resulting data is copied to an external disk which makes it possible that the recorded tomographic datasets can be taken to the home laboratory immediately after the beamtime shifts.

This is where the real work begins\ldots